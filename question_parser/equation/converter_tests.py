import unittest

from docx import Document

from extension.equation.wordexportutil import word_exporter


class MathTypeParserTests(unittest.TestCase):
    def test_question(self):
        doc = Document()
        p = doc.add_paragraph()
        word_exporter.render_contents(p, "<div>第1题 " +
                                 r"""
  ﻿<p>设<span class="mathquill-rendered-math" mathquill-block-id="1" data-latex="a_1=2,a_{n+1}=\frac{2}{a_n+1},b_n=|\frac{a_n+2}{a_n-1}|,n\in N^{\ast}" adjustformula="true"><span class="textarea"><textarea></textarea></span><var mathquill-command-id="3">a</var><sub class="non-leaf" mathquill-command-id="5" mathquill-block-id="7"><span mathquill-command-id="6">1</span></sub><span class="binary-operator" mathquill-command-id="9">=</span><span mathquill-command-id="11">2</span><span mathquill-command-id="13">,</span><var mathquill-command-id="15">a</var><sub class="non-leaf" mathquill-command-id="17" mathquill-block-id="19"><var mathquill-command-id="18">n</var><span mathquill-command-id="20" class="binary-operator">+</span><span mathquill-command-id="22">1</span></sub><span class="binary-operator" mathquill-command-id="25">=</span><span class="fraction non-leaf" mathquill-command-id="27"><span class="numerator" mathquill-block-id="29"><span mathquill-command-id="28">2</span></span><span class="denominator" mathquill-block-id="31"><var mathquill-command-id="30">a</var><sub class="non-leaf" mathquill-command-id="32" mathquill-block-id="34"><var mathquill-command-id="33">n</var></sub><span mathquill-command-id="36" class="binary-operator">+</span><span mathquill-command-id="38">1</span></span><span style="display:inline-block;width:0">&nbsp;</span></span><span mathquill-command-id="41">,</span><var mathquill-command-id="43">b</var><sub class="non-leaf" mathquill-command-id="45" mathquill-block-id="47"><var mathquill-command-id="46">n</var></sub><span class="binary-operator" mathquill-command-id="49">=</span><span mathquill-command-id="51">|</span><span class="fraction non-leaf" mathquill-command-id="53"><span class="numerator" mathquill-block-id="55"><var mathquill-command-id="54">a</var><sub class="non-leaf" mathquill-command-id="56" mathquill-block-id="58"><var mathquill-command-id="57">n</var></sub><span mathquill-command-id="60" class="binary-operator">+</span><span mathquill-command-id="62">2</span></span><span class="denominator" mathquill-block-id="65"><var mathquill-command-id="64">a</var><sub class="non-leaf" mathquill-command-id="66" mathquill-block-id="68"><var mathquill-command-id="67">n</var></sub><span mathquill-command-id="70" class="binary-operator">−</span><span mathquill-command-id="72">1</span></span><span style="display:inline-block;width:0">&nbsp;</span></span><span mathquill-command-id="75">|</span><span mathquill-command-id="77">,</span><var mathquill-command-id="79">n</var><span class="binary-operator" mathquill-command-id="81">∈</span><var mathquill-command-id="83">N</var><sup class="non-leaf" mathquill-command-id="85" mathquill-block-id="87"><span class="binary-operator" mathquill-command-id="86">∗</span></sup></span>，则数列<span style="font-size: 13px; line-height: 20px; white-space: normal;">{</span><span class="mathquill-rendered-math" mathquill-block-id="1" data-latex="b_n" adjustformula="true"><span class="textarea"><textarea></textarea></span><var mathquill-command-id="9">b</var><sub class="non-leaf" mathquill-command-id="5" mathquill-block-id="7"><var mathquill-command-id="6">n</var></sub></span><span style="font-size: 13px; line-height: 20px; white-space: normal;">}</span>的通项公式<span class="mathquill-rendered-math" mathquill-block-id="1" data-latex="b_n" adjustformula="true"><span class="textarea"><textarea></textarea></span><var mathquill-command-id="3">b</var><sub class="non-leaf" mathquill-command-id="5" mathquill-block-id="7"><var mathquill-command-id="6">n</var></sub></span>&nbsp;= ___________。</p>
                                 """
                                      + "</div>")

        doc.save(r"/Users/YuanXu/Downloads/lq/5121.docx")
